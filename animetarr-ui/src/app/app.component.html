<mat-toolbar>
  <mat-icon class="logo-icon">theaters</mat-icon>
  Animetarr
  <span class="spacer"></span>


  <form #f="ngForm">
    <select name="selectedYear" [(ngModel)]="selectedYear" (change)="loadSchedule()">
      <option [value]="year" *ngFor="let year of [2021,2020,2019,2018]">{{ year }}
      </option>
    </select>
    <select name="selectedSeason" [(ngModel)]="selectedSeason" (change)="loadSchedule()">
      <option [value]="season" *ngFor="let season of ['winter', 'spring', 'summer','fall']">{{ season | titlecase }}
      </option>
    </select>
  </form>

  <!-- <button mat-icon-button (click)="loadSchedule()">
    <mat-icon>refresh</mat-icon>
  </button> -->
</mat-toolbar>
<div class="scrollable-content">
  <div *ngIf="!isLoading" class="content">
    <div fxLayout="row wrap" fxLayoutGap="16px grid">
      <div fxFlex="33%" fxFlex.md="50%" fxFlex.sm="100%" fxFlex.xs="100%" *ngFor="let show of matchedShows">
        <mat-card class="mat-elevation-z4">
          <mat-card-content>
            <div fxFlex="row">
              <div class=poster fxFlex>
                <img class="mat-elevation-z6 rounded" [src]="show.posterUrl" alt="poster">
                <div class="left-pill mat-elevation-z3">
                  <mat-icon class="side-icon">tv</mat-icon>
                  <span>{{show.airdate|date}}</span>
                </div>
              </div>
              <div class="details">
                <div class="titles">
                  <div class="title" matTooltip="{{show.aliases.join(', ')}}">{{show.title}}</div>
                  <div class="subtitle">
                    <strong>{{show.season|titlecase}} {{show.queryYear}}</strong> - <em>{{show.status}}</em>
                  </div>
                </div>
                <div class="description">
                  <span>{{show.description | truncate:300:true}}
                    <mat-icon class="more-description-icon" *ngIf="show.description.length > 300"
                      (click)="showCompleteDescription(show)" [inline]=true>
                      description</mat-icon>
                  </span>
                </div>
                <div class="chips">
                  <mat-chip-list>
                    <mat-chip *ngFor="let tag of show.tags" color="accent" selected>{{tag}}</mat-chip>
                  </mat-chip-list>
                </div>
              </div>
            </div>
          </mat-card-content>
          <mat-card-actions>
            <span class="left-buttons">
              <button mat-icon-button (click)="showVideo(show)" matTooltip="View preview videos">
                <mat-icon>video_library</mat-icon>
              </button>
              <button mat-icon-button (click)="markMismatch(show)" matTooltip="Mark mismatched">
                <mat-icon>warning</mat-icon>
              </button>
            </span>
            <button mat-mini-fab color="primary" (click)="addToSonarr(show)" [disabled]="alreadyExists(show)">
              <mat-icon>{{alreadyExists(show)?"check_circle":"add_to_queue"}}</mat-icon>
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>
  </div>
  <mat-toolbar *ngIf="mismatchedShows.length > 0"> color="warning">Mismatched</mat-toolbar>
  <div *ngIf="mismatchedShows.length > 0" class="content">
    <div fxFlex="33%" fxFlex.md="50%" fxFlex.sm="100%" fxFlex.xs="100%" *ngFor="let show of mismatchedShows">
      <mat-card class="mat-elevation-z4">
        <mat-card-content>
          <div fxFlex="row">
            <div class=poster fxFlex>
              <img class="mat-elevation-z6 rounded" [src]="show.posterUrl" alt="poster">
              <div class="left-pill mat-elevation-z3">
                <mat-icon class="side-icon">tv</mat-icon>
                <span>{{show.airdate|date}}</span>
              </div>
            </div>
            <div class="details">
              <div class="titles">
                <div class="title" matTooltip="{{show.aliases.join(', ')}}">{{show.title}}</div>
                <div class="subtitle">
                  <strong>{{show.season|titlecase}} {{show.queryYear}}</strong> - <em>{{show.status}}</em>
                </div>
              </div>
              <div class="description">{{show.description}}</div>
              <div class="chips">
                <mat-chip-list>
                  <mat-chip *ngFor="let tag of show.tags" color="accent">{{tag}}</mat-chip>
                </mat-chip-list>
              </div>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <span class="left-buttons">
            <button mat-icon-button (click)="showVideo(show)" matTooltip="View preview videos">
              <mat-icon>video_library</mat-icon>
            </button>
            <button mat-icon-button (click)="markMismatch(show)" matTooltip="Mark mismatched">
              <mat-icon>warning</mat-icon>
            </button>
          </span>
          <button mat-raised-button color="accent" (click)="addToSonarr(show)"
            [disabled]="alreadyExists(show)">{{alreadyExists(show)?"Monitored":"Add"}}</button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>
